{"version":3,"file":"Index-5c5cdadd.js","sources":["../../../../js/annotatedimage/Index.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport type { Gradio, SelectData } from \"@gradio/utils\";\n\n\timport { Block, BlockLabel, Empty } from \"@gradio/atoms\";\n\timport { Image } from \"@gradio/icons\";\n\timport { StatusTracker } from \"@gradio/statustracker\";\n\timport type { LoadingStatus } from \"@gradio/statustracker\";\n\timport { type FileData, normalise_file } from \"@gradio/client\";\n\n\texport let elem_id = \"\";\n\texport let elem_classes: string[] = [];\n\texport let visible = true;\n\texport let value: {\n\t\timage: FileData;\n\t\tannotations: { image: FileData; label: string }[] | [];\n\t} | null = null;\n\tlet old_value: {\n\t\timage: FileData;\n\t\tannotations: { image: FileData; label: string }[] | [];\n\t} | null = null;\n\tlet _value: {\n\t\timage: FileData;\n\t\tannotations: { image: FileData; label: string }[];\n\t} | null = null;\n\texport let gradio: Gradio<{\n\t\tchange: undefined;\n\t\tselect: SelectData;\n\t}>;\n\texport let label = gradio.i18n(\"annotated_image.annotated_image\");\n\texport let show_label = true;\n\texport let show_legend = true;\n\texport let height: number | undefined;\n\texport let width: number | undefined;\n\texport let color_map: Record<string, string>;\n\texport let container = true;\n\texport let scale: number | null = null;\n\texport let min_width: number | undefined = undefined;\n\texport let root: string;\n\texport let proxy_url: string;\n\tlet active: string | null = null;\n\texport let loading_status: LoadingStatus;\n\n\t$: {\n\t\tif (value !== old_value) {\n\t\t\told_value = value;\n\t\t\tgradio.dispatch(\"change\");\n\t\t}\n\t\tif (value) {\n\t\t\t_value = {\n\t\t\t\timage: normalise_file(value.image, root, proxy_url) as FileData,\n\t\t\t\tannotations: value.annotations.map((ann) => ({\n\t\t\t\t\timage: normalise_file(ann.image, root, proxy_url) as FileData,\n\t\t\t\t\tlabel: ann.label\n\t\t\t\t}))\n\t\t\t};\n\t\t} else {\n\t\t\t_value = null;\n\t\t}\n\t}\n\tfunction handle_mouseover(_label: string): void {\n\t\tactive = _label;\n\t}\n\tfunction handle_mouseout(): void {\n\t\tactive = null;\n\t}\n\n\tfunction handle_click(i: number, value: string): void {\n\t\tgradio.dispatch(\"select\", {\n\t\t\tvalue: label,\n\t\t\tindex: i\n\t\t});\n\t}\n</script>\n\n<Block\n\t{visible}\n\t{elem_id}\n\t{elem_classes}\n\tpadding={false}\n\t{height}\n\t{width}\n\tallow_overflow={false}\n\t{container}\n\t{scale}\n\t{min_width}\n>\n\t<StatusTracker\n\t\tautoscroll={gradio.autoscroll}\n\t\ti18n={gradio.i18n}\n\t\t{...loading_status}\n\t/>\n\t<BlockLabel\n\t\t{show_label}\n\t\tIcon={Image}\n\t\tlabel={label || gradio.i18n(\"image.image\")}\n\t/>\n\n\t<div class=\"container\">\n\t\t{#if _value == null}\n\t\t\t<Empty size=\"large\" unpadded_box={true}><Image /></Empty>\n\t\t{:else}\n\t\t\t<div class=\"image-container\">\n\t\t\t\t<img\n\t\t\t\t\tclass=\"base-image\"\n\t\t\t\t\tclass:fit-height={height}\n\t\t\t\t\tsrc={_value ? _value.image.url : null}\n\t\t\t\t\talt=\"the base file that is annotated\"\n\t\t\t\t/>\n\t\t\t\t{#each _value ? _value?.annotations : [] as ann, i}\n\t\t\t\t\t<img\n\t\t\t\t\t\talt=\"segmentation mask identifying {label} within the uploaded file\"\n\t\t\t\t\t\tclass=\"mask fit-height\"\n\t\t\t\t\t\tclass:active={active == ann.label}\n\t\t\t\t\t\tclass:inactive={active != ann.label && active != null}\n\t\t\t\t\t\tsrc={ann.image.url}\n\t\t\t\t\t\tstyle={color_map && ann.label in color_map\n\t\t\t\t\t\t\t? null\n\t\t\t\t\t\t\t: `filter: hue-rotate(${Math.round(\n\t\t\t\t\t\t\t\t\t(i * 360) / _value?.annotations.length\n\t\t\t\t\t\t\t  )}deg);`}\n\t\t\t\t\t/>\n\t\t\t\t{/each}\n\t\t\t</div>\n\t\t\t{#if show_legend && _value}\n\t\t\t\t<div class=\"legend\">\n\t\t\t\t\t{#each _value.annotations as ann, i}\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"legend-item\"\n\t\t\t\t\t\t\tstyle=\"background-color: {color_map && ann.label in color_map\n\t\t\t\t\t\t\t\t? color_map[ann.label] + '88'\n\t\t\t\t\t\t\t\t: `hsla(${Math.round(\n\t\t\t\t\t\t\t\t\t\t(i * 360) / _value.annotations.length\n\t\t\t\t\t\t\t\t  )}, 100%, 50%, 0.3)`}\"\n\t\t\t\t\t\t\ton:mouseover={() => handle_mouseover(ann.label)}\n\t\t\t\t\t\t\ton:focus={() => handle_mouseover(ann.label)}\n\t\t\t\t\t\t\ton:mouseout={() => handle_mouseout()}\n\t\t\t\t\t\t\ton:blur={() => handle_mouseout()}\n\t\t\t\t\t\t\ton:click={() => handle_click(i, ann.label)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ann.label}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t{/each}\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t{/if}\n\t</div>\n</Block>\n\n<style>\n\t.base-image {\n\t\tdisplay: block;\n\t\twidth: 100%;\n\t\theight: auto;\n\t}\n\t.container {\n\t\tdisplay: flex;\n\t\tposition: relative;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t}\n\t.image-container {\n\t\tposition: relative;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tflex-grow: 1;\n\t\twidth: 100%;\n\t\toverflow: hidden;\n\t}\n\t.fit-height {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tobject-fit: contain;\n\t}\n\t.mask {\n\t\topacity: 0.85;\n\t\ttransition: all 0.2s ease-in-out;\n\t}\n\t.image-container:hover .mask {\n\t\topacity: 0.3;\n\t}\n\t.mask.active {\n\t\topacity: 1;\n\t}\n\t.mask.inactive {\n\t\topacity: 0;\n\t}\n\t.legend {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tflex-wrap: wrap;\n\t\talign-content: center;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tgap: var(--spacing-sm);\n\t\tpadding: var(--spacing-sm);\n\t}\n\t.legend-item {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t\tcursor: pointer;\n\t\tborder-radius: var(--radius-sm);\n\t\tpadding: var(--spacing-sm);\n\t}\n</style>\n"],"names":[],"mappings":"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"}